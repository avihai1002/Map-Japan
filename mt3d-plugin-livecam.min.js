/*!
 * mt3d-plugin-livecam v1.2.0
 * https://minitokyo3d.com
 * (c) 2021-2023 Akihiko Kusanagi
 * Released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("mini-tokyo-3d")):"function"==typeof define&&define.amd?define(["mini-tokyo-3d"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).mt3dLivecam=t(e.mt3d)}(this,(function(e){"use strict";!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===o&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}(".livecam-panel{height:262px!important}.livecam-panel.collapsed{height:50px!important}.livecam-panel.closed{height:0!important}.livecam-marker{background:#fff no-repeat 50%/20px url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512' fill='%23333'%3E%3C!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--%3E%3Cpath d='M0 128c0-35.3 28.7-64 64-64h256c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zm559.1-28.2c10.4 5.6 16.9 16.4 16.9 28.2v256c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64-14.2-9.5V174.9l14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z'/%3E%3C/svg%3E\");border:2px solid #333;border-radius:50%;cursor:pointer;height:40px;width:40px}.livecam-marker.active,.livecam-marker:hover{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512' fill='%2333B5E5'%3E%3C!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--%3E%3Cpath d='M0 128c0-35.3 28.7-64 64-64h256c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zm559.1-28.2c10.4 5.6 16.9 16.4 16.9 28.2v256c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64-14.2-9.5V174.9l14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z'/%3E%3C/svg%3E\");border-color:#33b5e5}");function t(e,t){const o=t.replace("#","%23");return e.replace("%3e",` fill='${o}' stroke='${o}'%3e`)}function o(e,t,o){const n=document.createElement(e);return Object.assign(n,t),o&&o.appendChild(n),n}class n extends e.Panel{constructor(e){super(Object.assign({className:"livecam-panel"},e))}addTo(e){const{name:t,html:o}=this._options.camera;return this.setTitle(t[e.lang]).setHTML(o),super.addTo(e)}}class s{constructor(){const e=this;e.id="livecam",e.name={en:"Live Cameras",fr:"Caméras en direct",ja:"ライブカメラ",ko:"실시간 웹캠",ne:"प्रत्यक्ष क्यामेरा",pt:"Câmeras ao vivo",th:"กล้องถ่ายทอดสด","zh-Hans":"实时摄像头","zh-Hant":"實時攝像頭"},e.iconStyle={backgroundSize:"32px",backgroundImage:`url("${t("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3e%3c!--! Font Awesome Free 6.4.0 by %40fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0%2c Fonts: SIL OFL 1.1%2c Code: MIT License) Copyright 2023 Fonticons%2c Inc. --%3e%3cpath d='M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2V384c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1V320 192 174.9l14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z'/%3e%3c/svg%3e","white")}")`},e.clockModes=["realtime"],e.viewModes=["ground"],e.cameras={},e.markers={},e._onSelection=e._onSelection.bind(e),e._onDeselection=e._onDeselection.bind(e)}onAdd(e){this.map=e}onEnabled(){const e=this,{map:t,cameras:o}=e;t.on("selection",e._onSelection),t.on("deselection",e._onDeselection),fetch("https://mini-tokyo.appspot.com/livecam").then((e=>e.json())).then((t=>{for(const e of t)o[e.id]=e;e._addMarkers()}))}onDisabled(){const e=this,{map:t}=e;t.off("selection",e._onSelection),t.off("deselection",e._onDeselection),e.panel&&(t.trackObject(),e.panel.remove(),delete e.panel);for(const t of Object.keys(e.cameras))delete e.cameras[t];for(const t of Object.keys(e.markers))e.markers[t].remove(),delete e.markers[t]}onVisibilityChanged(e){const t=this;t.visible=e,!e&&t.panel&&t.map.trackObject();for(const o of Object.keys(t.markers))t.markers[o].setVisibility(e)}_addMarkers(){const t=this,{map:n,visible:s}=t,{lang:i}=n;for(const c of Object.keys(t.cameras)){const{center:a,zoom:r,bearing:l,pitch:m,name:d,thumbnail:p}=t.cameras[c],v=o("div",{className:"livecam-marker"}),h={id:c,selectionType:"livecam"};let f;t.markers[c]=new e.Marker({element:v}).setLngLat(a).addTo(n).setVisibility(s).on("click",(()=>{n.trackObject(h),n.getMapboxMap().flyTo({center:a,zoom:r,bearing:l,pitch:m})})).on("mouseenter",(()=>{f=(new e.Popup).setLngLat(a).setHTML(['<div class="thumbnail-image-container">','<div class="ball-pulse"><div></div><div></div><div></div></div>',`<div class="thumbnail-image" style="background-image: url('${p}');"></div>`,"</div>",`<div><strong>${d[i]}</strong></div>`].join("")).addTo(n)})).on("mouseleave",(()=>{f&&(f.remove(),f=void 0)}))}}_onSelection(e){if("livecam"===e.selectionType){const t=this,{id:o}=e;t.markers[o].setActivity(!0),t.panel=new n({camera:t.cameras[o]}).addTo(t.map)}}_onDeselection(e){if("livecam"===e.selectionType){const t=this,o=t.markers[e.id];o&&o.setActivity(!1),t.panel&&(t.panel.remove(),delete t.panel)}}}return function(){return new s}}));
//# sourceMappingURL=mt3d-plugin-livecam.min.js.map
